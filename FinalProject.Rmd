---
title: "FinalProject"
author: "Kishan Thambu"
date: "4/18/2022"
output: html_document
---

```{r setup, include=FALSE}
# Installed/Required Packages 
# Geosphere (Required for calculating store distance)
# https://cran.r-project.org/web/packages/geosphere/vignettes/geosphere.pdf
library ("geosphere")
library("ggplot2")

# Data setup
healthfooddata <- read.csv("healthfooddata.csv")
saltlakecitydata <- healthfooddata[which(healthfooddata$city == 'Salt Lake City'),]
provodata <- healthfooddata[which(healthfooddata$city == 'Provo'),]
southjordandata <- healthfooddata[which(healthfooddata$city == 'South Jordan'),]
oremdata <- healthfooddata[which(healthfooddata$city == 'Orem'),]
logandata <- healthfooddata[which(healthfooddata$city == 'Logan'),]
wellingtondata <- healthfooddata[which(healthfooddata$city == 'Wellington'),]
morgandata <- healthfooddata[which(healthfooddata$city == 'Morgan'),]
farmingtondata <- healthfooddata[which(healthfooddata$city == 'Farmington'),]
rooseveltdata <- healthfooddata[which(healthfooddata$city == 'Roosevelt'),]
woodscrossdata <- healthfooddata[which(healthfooddata$city == 'Woods Cross'),]
```

## Summary Statistics on Population

```{r}
summary(saltlakecitydata)
summary(provodata)
summary(southjordandata)
summary(oremdata)
summary(logandata)
summary(wellingtondata)
summary(morgandata)
summary(farmingtondata)
summary(rooseveltdata)
summary(woodscrossdata)
```


Plotting City population and Median Household income

```{r}
# population plot
totalPopulations <- c(saltlakecitydata$population[1], provodata$population[1], southjordandata$population[1], oremdata$population[1],
                      logandata$population[1], wellingtondata$population[1], morgandata$population[1], farmingtondata$population[1],
                      rooseveltdata$population[1], woodscrossdata$population[1])
barplot(totalPopulations, 
        names.arg = c("SLC", "Provo", "South Jordan", "Orem", "Logan", "Wellington", "Morgan", "Farmington", "Roosevelt", "Woods Cross"), 
        xlab = "Cities",
        ylab = "Number Of People", 
        main = "Population Bar Plot", 
        col=c("#1b98e0", "#1b98e0", "#1b98e0", "#1b98e0", "#1b98e0",  "#111111", "#111111", "#111111", "#111111", "#111111"), las = 3)
legend("topright",                                    # Add legend to bar plot
       legend = c("Urban Cities", "Rural Cities"),
       fill = c("#1b98e0", "#111111"))

# median income plot
totalMedianIncome <- c(saltlakecitydata$median.household.income[1], provodata$median.household.income[1], 
                       southjordandata$median.household.income[1], oremdata$median.household.income[1], logandata$median.household.income[1], 
                       wellingtondata$median.household.income[1], morgandata$median.household.income[1], farmingtondata$median.household.income[1], 
                       rooseveltdata$median.household.income[1], woodscrossdata$median.household.income[1])
barplot(totalMedianIncome, 
        names.arg = c("SLC", "Provo", "South Jordan", "Orem", "Logan", "Wellington", "Morgan", "Farmington", "Roosevelt", "Woods Cross"), 
        xlab = "Cities", 
        ylab = "Median Income by Dollar", 
        main = "Medium Income Bar Plot", 
        col=c("#1b98e0", "#1b98e0", "#1b98e0", "#1b98e0", "#1b98e0",  "#111111", "#111111", "#111111", "#111111", "#111111"), las = 3)
legend("topright",                                    # Add legend to bar plot
       legend = c("Urban Cities", "Rural Cities"),
       fill = c("#1b98e0", "#111111"))

# Vehicles (by county)

```


## Store Accessibility

Store Distance

```{r}
# Calculating average store distance from longitude and latitude for urban cities
# Initialize distance arrays
slcdist <- replicate(10,0)
logandist <- replicate(10,0)
provodist <- replicate(10,0)
oremdist <- replicate(10,0)
sjdist <- replicate(10,0)

# Loop through and calculate distances between all store variations
i = 0
for (x in 1:5) {
  nextStore = x + 1
  if (nextStore == 6)
    next
  for (y in nextStore:5) {
    if (x != y) {
      i = i + 1
      
      slcdist[i] <- distHaversine(c(saltlakecitydata$longitude[x], saltlakecitydata$latitude[x]),
                           c(saltlakecitydata$longitude[y], saltlakecitydata$latitude[y]))
      
      logandist[i] <- distHaversine(c(logandata$longitude[x], logandata$latitude[x]),
                           c(logandata$longitude[y], logandata$latitude[y]))
      
      provodist[i] <- distHaversine(c(provodata$longitude[x], provodata$latitude[x]),
                           c(provodata$longitude[y], provodata$latitude[y]))
      
      oremdist[i] <- distHaversine(c(oremdata$longitude[x], oremdata$latitude[x]),
                           c(oremdata$longitude[y], oremdata$latitude[y]))
      
      sjdist[i] <- distHaversine(c(southjordandata$longitude[x], southjordandata$latitude[x]),
                           c(southjordandata$longitude[y], southjordandata$latitude[y]))
    }
  }
}

# Calculate average distance
slcavgdist = mean(slcdist)
loganavgdist = mean(logandist)
provoavgdist = mean(provodist)
oremavgdist = mean(oremdist)
sjavgdist = mean(sjdist)
```

```{r}
# Calculating average store distances from longitude and latitude for rural cities
# Initialize distance arrays
farmingtondist <- replicate(10,0)
morgandist <- replicate(10,0)
wellingtondist <- replicate(10,0)
rooseveltdist <- replicate(10,0)
woodscrossdist <- replicate(10,0)

# Loop through and calculate distances between all store variations
i = 0
for (x in 1:5) {
  nextStore = x + 1
  if (nextStore == 6)
    next
  for (y in nextStore:5) {
    if (x != y) {
      i = i + 1
      
      farmingtondist[i] <- distHaversine(c(farmingtondata$longitude[x], farmingtondata$latitude[x]),
                           c(farmingtondata$longitude[y], farmingtondata$latitude[y]))
      
      morgandist[i] <- distHaversine(c(morgandata$longitude[x], morgandata$latitude[x]),
                           c(morgandata$longitude[y], morgandata$latitude[y]))
            
      wellingtondist[i] <- distHaversine(c(wellingtondata$longitude[x], wellingtondata$latitude[x]),
                           c(wellingtondata$longitude[y], wellingtondata$latitude[y]))
      
      rooseveltdist[i] <- distHaversine(c(rooseveltdata$longitude[x], rooseveltdata$latitude[x]),
                           c(rooseveltdata$longitude[y], rooseveltdata$latitude[y]))
      
      woodscrossdist[i] <- distHaversine(c(woodscrossdata$longitude[x], woodscrossdata$latitude[x]),
                           c(woodscrossdata$longitude[y], woodscrossdata$latitude[y]))
    }
  }
}

# Calculate average distance
farmingtonavgdist = mean(farmingtondist)
morganavgdist = mean(morgandist)
wellingtonavgdist = mean(wellingtondist)
rooseveltavgdist = mean(rooseveltdist)
woodscrossavgdist = mean(woodscrossdist)
```

```{r}
# store all average distances in a new array
totalAvgDistances <- c(slcavgdist, provoavgdist, sjavgdist, oremavgdist, loganavgdist, wellingtonavgdist,
                     morganavgdist, farmingtonavgdist, rooseveltavgdist, woodscrossavgdist)

# distance plot
barplot(totalAvgDistances, 
        names.arg = c("SLC", "Provo", "South Jordan", "Orem", "Logan", "Wellington", "Morgan", "Farmington", "Roosevelt", "Woods Cross"), 
        xlab = "Cities",
        ylab = "Distance in Meters (m)", 
        main = "Average Distance between 5 stores", 
        col=c("#1b98e0", "#1b98e0", "#1b98e0", "#1b98e0", "#1b98e0",  "#111111", "#111111", "#111111", "#111111", "#111111"), las = 3)
 # Add legend to bar plot
legend("topright",
       legend = c("Urban Cities", "Rural Cities"),
       fill = c("#1b98e0", "#111111"))

# total average distances histogram - How does store distance behave for all of Utah?
lattice::histogram(totalAvgDistances, breaks = 10,
                   main = paste("Total Average Distances Histogram"),
                   xlab = "Store Distance in Meters")
```


```{r}
# Store total number of store types per city
saltlakecityTotalStoreTypes <- c(length(saltlakecitydata[which(saltlakecitydata$store.type == 'Organic Grocery Store'),6]), 
                                 length(saltlakecitydata[which(saltlakecitydata$store.type == 'Grocery Store'),6]), 
                                 length(saltlakecitydata[which(saltlakecitydata$store.type == 'Convenience Store'),6]))

provoTotalStoreTypes <- c(length(provodata[which(provodata$store.type == 'Organic Grocery Store'),6]),
                          length(provodata[which(provodata$store.type == 'Grocery Store'),6]),
                          length(provodata[which(provodata$store.type == 'Convenience Store'),6]))

southjordanTotalStoreTypes <- c(length(southjordandata[which(southjordandata$store.type == 'Organic Grocery Store'),6]), 
                                length(southjordandata[which(southjordandata$store.type == 'Grocery Store'),6]), 
                                length(southjordandata[which(southjordandata$store.type == 'Convenience Store'),6]))

oremTotalStoreTypes <- c(length(oremdata[which(oremdata$store.type == 'Organic Grocery Store'),6]), 
                         length(oremdata[which(oremdata$store.type == 'Grocery Store'),6]), 
                         length(oremdata[which(oremdata$store.type == 'Convenience Store'),6]))

loganTotalStoreTypes <- c(length(logandata[which(logandata$store.type == 'Organic Grocery Store'),6]), 
                          length(logandata[which(logandata$store.type == 'Grocery Store'),6]), 
                          length(logandata[which(logandata$store.type == 'Convenience Store'),6]))

wellingtonTotalStoreTypes <- c(length(wellingtondata[which(wellingtondata$store.type == 'Organic Grocery Store'),6]), 
                               length(wellingtondata[which(wellingtondata$store.type == 'Grocery Store'),6]), 
                               length(wellingtondata[which(wellingtondata$store.type == 'Convenience Store'),6]))

morganTotalStoreTypes <- c(length(morgandata[which(morgandata$store.type == 'Organic Grocery Store'),6]), 
                           length(morgandata[which(morgandata$store.type == 'Grocery Store'),6]), 
                           length(morgandata[which(morgandata$store.type == 'Convenience Store'),6]))

farmingtonTotalStoreTypes <- c(length(farmingtondata[which(farmingtondata$store.type == 'Organic Grocery Store'),6]), 
                               length(farmingtondata[which(farmingtondata$store.type == 'Grocery Store'),6]), 
                               length(farmingtondata[which(farmingtondata$store.type == 'Convenience Store'),6]))

rooseveltTotalStoreTypes <- c(length(rooseveltdata[which(rooseveltdata$store.type == 'Organic Grocery Store'),6]), 
                              length(rooseveltdata[which(rooseveltdata$store.type == 'Grocery Store'),6]), 
                              length(rooseveltdata[which(rooseveltdata$store.type == 'Convenience Store'),6]))

woodscrossTotalStoreTypes <- c(length(woodscrossdata[which(woodscrossdata$store.type == 'Organic Grocery Store'),6]), 
                               length(woodscrossdata[which(woodscrossdata$store.type == 'Grocery Store'),6]), 
                               length(woodscrossdata[which(woodscrossdata$store.type == 'Convenience Store'),6]))


# combine vectors using c bind function
totalStoreTypes <- cbind(saltlakecityTotalStoreTypes, provoTotalStoreTypes, southjordanTotalStoreTypes, oremTotalStoreTypes, 
                         loganTotalStoreTypes, wellingtonTotalStoreTypes, morganTotalStoreTypes, farmingtonTotalStoreTypes, 
                         rooseveltTotalStoreTypes, woodscrossTotalStoreTypes)
# plot total store types
barplot(totalStoreTypes , beside=T, 
        names.arg = c("SLC", "Provo", "South Jordan", "Orem", "Logan", "Wellington", "Morgan", "Farmington", "Roosevelt", "Woods Cross"), 
        xlab = "Cities",
        ylab = "Stores", 
        main = "Store Types Found in Each City", 
        col=c("#1b98e0", "#111111", "#aaaaaa"), las = 3)
# add legend to bar plot
legend("topright",
       legend = c("Organic Grocery Store", "Grocery Store", "Convenience Store"),
       fill = c("#1b98e0", "#111111", "#aaaaaa"))
```

## Confidence Interval on Distance between stores

```{r}
# 95% confidence level - How confident are we that the mean of our sample is an accurate representation of the true population?
t.test(slcdist, conf.level = 0.95)
t.test(logandist, conf.level = 0.95)
t.test(provodist, conf.level = 0.95)
t.test(oremdist, conf.level = 0.95)
t.test(sjdist, conf.level = 0.95)
t.test(farmingtondist, conf.level = 0.95)
t.test(morgandist, conf.level = 0.95)
t.test(wellingtondist, conf.level = 0.95)
t.test(rooseveltdist, conf.level = 0.95)
t.test(woodscrossdist, conf.level = 0.95)
```






