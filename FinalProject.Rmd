---
title: "FinalProject"
author: "Kishan Thambu"
date: "4/18/2022"
output: html_document
---

```{r setup, include=FALSE}
# Installed/Required Packages 
# Geosphere (Required for calculating store distance)
# https://cran.r-project.org/web/packages/geosphere/vignettes/geosphere.pdf
library ("geosphere")

# Data setup
healthfooddata <- read.csv("healthfooddata.csv")
saltlakecitydata <- healthfooddata[which(healthfooddata$city == 'Salt Lake City'),]
provodata <- healthfooddata[which(healthfooddata$city == 'Provo'),]
southjordandata <- healthfooddata[which(healthfooddata$city == 'South Jordan'),]
oremdata <- healthfooddata[which(healthfooddata$city == 'Orem'),]
logandata <- healthfooddata[which(healthfooddata$city == 'Logan'),]
wellingtondata <- healthfooddata[which(healthfooddata$city == 'Wellington'),]
morgandata <- healthfooddata[which(healthfooddata$city == 'Morgan'),]
farmingtondata <- healthfooddata[which(healthfooddata$city == 'Farmington'),]
rooseveltdata <- healthfooddata[which(healthfooddata$city == 'Roosevelt'),]
woodscrossdata <- healthfooddata[which(healthfooddata$city == 'Woods Cross'),]
```

## Summary Statistics on Population

```{r}
summary(saltlakecitydata)
summary(provodata)
summary(southjordandata)
summary(oremdata)
summary(logandata)
summary(wellingtondata)
summary(morgandata)
summary(farmingtondata)
summary(rooseveltdata)
summary(woodscrossdata)
```


Plotting City population and Median Household income


```{r}
# population plot
barplot(c(saltlakecitydata$population[1], provodata$population[1], southjordandata$population[1], oremdata$population[1], logandata$population[1], wellingtondata$population[1], morgandata$population[1], farmingtondata$population[1], rooseveltdata$population[1], woodscrossdata$population[1]))

# median income plot
barplot(c(saltlakecitydata$median.household.income[1], provodata$median.household.income[1], southjordandata$median.household.income[1], oremdata$median.household.income[1], logandata$median.household.income[1], wellingtondata$median.household.income[1], morgandata$median.household.income[1], farmingtondata$median.household.income[1], rooseveltdata$median.household.income[1], woodscrossdata$median.household.income[1]))

# Vehicles (by county)

```


## Store Accessibility

Store Distance

```{r}
# Calculating salt lake city average store distance from longitude and latitude
slcavgdist = 0
for (x in 1:5) {
  i = x + 1
  if (i == 6)
    next
  for (y in i:5) {
    if (x != y) {
      temp = distHaversine(c(saltlakecitydata$longitude[x], saltlakecitydata$latitude[x]),
                           c(saltlakecitydata$longitude[y], saltlakecitydata$latitude[y]))
      slcavgdist = temp + slcavgdist
    }
  }
}
slcavgdist = slcavgdist / 10
```


```{r}
# Calculating logan average store distance from longitude and latitude
loganavgdist = 0
for (x in 1:5) {
  i = x + 1
  if (i == 6)
    next
  for (y in i:5) {
    if (x != y) {
      temp = distHaversine(c(logandata$longitude[x], logandata$latitude[x]),
                           c(logandata$longitude[y], logandata$latitude[y]))
      loganavgdist = temp + loganavgdist
    }
  }
}
loganavgdist = loganavgdist / 10
```

```{r}
# Calculating provo average store distance from longitude and latitude
provoavgdist = 0
for (x in 1:5) {
  i = x + 1
  if (i == 6)
    next
  for (y in i:5) {
    if (x != y) {
      temp = distHaversine(c(provodata$longitude[x], provodata$latitude[x]),
                           c(provodata$longitude[y], provodata$latitude[y]))
      provoavgdist = temp + provoavgdist
    }
  }
}
provoavgdist = provoavgdist / 10
```


```{r}
# Calculating orem average store distance from longitude and latitude
oremavgdist = 0
for (x in 1:5) {
  i = x + 1
  if (i == 6)
    next
  for (y in i:5) {
    if (x != y) {
      temp = distHaversine(c(oremdata$longitude[x], oremdata$latitude[x]),
                           c(oremdata$longitude[y], oremdata$latitude[y]))
      oremavgdist = temp + oremavgdist
    }
  }
}
oremavgdist = oremavgdist / 10
```

```{r}
# Calculating farmington average store distance from longitude and latitude
farmingtonavgdist = 0
for (x in 1:5) {
  i = x + 1
  if (i == 6)
    next
  for (y in i:5) {
    if (x != y) {
      temp = distHaversine(c(farmingtondata$longitude[x], farmingtondata$latitude[x]),
                           c(farmingtondata$longitude[y], farmingtondata$latitude[y]))
      farmingtonavgdist = temp + farmingtonavgdist
    }
  }
}
farmingtonavgdist = farmingtonavgdist / 10
```

```{r}
# Calculating morgan average store distance from longitude and latitude
morganavgdist = 0
for (x in 1:5) {
  i = x + 1
  if (i == 6)
    next
  for (y in i:5) {
    if (x != y) {
      temp = distHaversine(c(morgandata$longitude[x], morgandata$latitude[x]),
                           c(morgandata$longitude[y], morgandata$latitude[y]))
      morganavgdist = temp + morganavgdist
    }
  }
}
morganavgdist = morganavgdist / 10
```

```{r}
# Calculating roosevelt average store distance from longitude and latitude
rooseveltavgdist = 0
for (x in 1:5) {
  i = x + 1
  if (i == 6)
    next
  for (y in i:5) {
    if (x != y) {
      temp = distHaversine(c(rooseveltdata$longitude[x], rooseveltdata$latitude[x]),
                           c(rooseveltdata$longitude[y], rooseveltdata$latitude[y]))
      rooseveltavgdist = temp + rooseveltavgdist
    }
  }
}
rooseveltavgdist = rooseveltavgdist / 10
```

```{r}
# Calculating southjordan average store distance from longitude and latitude
southjordanavgdist = 0
for (x in 1:5) {
  i = x + 1
  if (i == 6)
    next
  for (y in i:5) {
    if (x != y) {
      temp = distHaversine(c(southjordandata$longitude[x], southjordandata$latitude[x]),
                           c(southjordandata$longitude[y], southjordandata$latitude[y]))
      southjordanavgdist = temp + southjordanavgdist
    }
  }
}
southjordanavgdist = southjordanavgdist / 10
```

```{r}
# Calculating wellington average store distance from longitude and latitude
wellingtonavgdist = 0
for (x in 1:5) {
  i = x + 1
  if (i == 6)
    next
  for (y in i:5) {
    if (x != y) {
      temp = distHaversine(c(wellingtondata$longitude[x], wellingtondata$latitude[x]),
                           c(wellingtondata$longitude[y], wellingtondata$latitude[y]))
      wellingtonavgdist = temp + wellingtonavgdist
    }
  }
}
wellingtonavgdist = wellingtonavgdist / 10
```

```{r}
# Calculating woodscross average store distance from longitude and latitude
woodscrossavgdist = 0
for (x in 1:5) {
  i = x + 1
  if (i == 6)
    next
  for (y in i:5) {
    if (x != y) {
      temp = distHaversine(c(woodscrossdata$longitude[x], woodscrossdata$latitude[x]),
                           c(woodscrossdata$longitude[y], woodscrossdata$latitude[y]))
      woodscrossavgdist = temp + woodscrossavgdist
    }
  }
}
woodscrossavgdist = woodscrossavgdist / 10
```


## Confidence Interval on Distance between stores
